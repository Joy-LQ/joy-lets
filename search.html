<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=375px, initial-scale=1.0">
  <title>Search ¬∑ Joy Lets</title>
  <link rel="stylesheet" href="css/style.css">
  <style>
    .filter-input {
      width: 100%;
      border: 1.5px solid var(--neutral-40);
      border-radius: 10px;
      padding: 12px 14px;
      font-size: 14px;
      font-family: inherit;
      outline: none;
      box-sizing: border-box;
      margin-top: 8px;
    }
    .filter-input:focus { border-color: var(--neutral-100); }
    .weekly-labels {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      color: var(--neutral-70);
      margin-top: 4px;
    }
    .range-slider {
      width: 100%;
      margin-top: 10px;
      accent-color: var(--neutral-100);
    }
    .weekly-value {
      font-size: 14px;
      font-weight: 600;
      color: var(--neutral-100);
      margin-top: 6px;
    }
  </style>
</head>
<body>
<div class="app">

  <!-- Status Bar -->
  <div class="status-bar">
    <span class="time" id="clock">9:41</span>
    <span class="icons">‚ñ≤ WiFi üîã</span>
  </div>

  <!-- Header -->
  <div class="page-header">
    <button class="back-btn" onclick="history.back()">‚Üê</button>
    <span class="page-title">Search</span>
  </div>

  <!-- Start Date -->
  <div class="filter-section">
    <div class="filter-section-title">When would you like to move in?</div>
    <div class="month-grid" id="month-grid">
      <!-- populated by JS -->
    </div>
  </div>

  <!-- Tenure -->
  <div class="filter-section">
    <div class="filter-section-title">How long is your lease?</div>
    <div class="tenure-options">
      <div class="tenure-option" id="tenure-10" onclick="selectTenure(10)">
        <div>
          <div class="tenure-title">10 Months</div>
          <div class="tenure-desc">Fixed term ¬∑ ends before Christmas</div>
        </div>
        <span class="tenure-check" id="check-10"></span>
      </div>
      <div class="tenure-option" id="tenure-12" onclick="selectTenure(12)">
        <div>
          <div class="tenure-title">12 Months</div>
          <div class="tenure-desc">Standard AST ¬∑ full year tenancy</div>
        </div>
        <span class="tenure-check" id="check-12"></span>
      </div>
    </div>
  </div>

  <!-- Postcode Filter -->
  <div class="filter-section">
    <div class="filter-section-title">Postcode area</div>
    <input class="filter-input" id="postcode-input" type="text" placeholder="e.g. M1, M14, M21" maxlength="4">
  </div>

  <!-- Weekly Price Filter -->
  <div class="filter-section">
    <div class="filter-section-title">Max budget per person per week</div>
    <input type="range" class="range-slider" id="weekly-slider" min="50" max="400" step="10" value="400">
    <div class="weekly-value">Up to ¬£<span id="weekly-display">400</span>/pp per week</div>
    <div class="weekly-labels"><span>¬£50</span><span>¬£400+</span></div>
  </div>

  <!-- Apply -->
  <button class="apply-btn" onclick="applySearch()">Show properties</button>

</div>
<script>
  // Clock
  function updateClock() {
    const now = new Date();
    document.getElementById('clock').textContent =
      now.getHours() + ':' + String(now.getMinutes()).padStart(2,'0');
  }
  updateClock();

  // Generate next 8 months
  const months = [];
  const now = new Date();
  for (let i = 0; i < 8; i++) {
    const d = new Date(now.getFullYear(), now.getMonth() + i, 1);
    months.push({
      label: d.toLocaleDateString('en-GB', { month: 'short', year: '2-digit' }),
      value: d.toLocaleDateString('en-GB', { month: 'long', year: 'numeric' })
    });
  }
  const grid = document.getElementById('month-grid');
  let selectedMonth = localStorage.getItem('startMonth') || null;
  let selectedTenure = parseInt(localStorage.getItem('tenure')) || null;

  months.forEach(m => {
    const btn = document.createElement('button');
    btn.className = 'month-btn' + (selectedMonth === m.value ? ' selected' : '');
    btn.textContent = m.label;
    btn.onclick = () => {
      selectedMonth = m.value;
      document.querySelectorAll('.month-btn').forEach(b => b.classList.remove('selected'));
      btn.classList.add('selected');
    };
    grid.appendChild(btn);
  });

  function selectTenure(months) {
    selectedTenure = months;
    document.querySelectorAll('.tenure-option').forEach(el => el.classList.remove('selected'));
    document.querySelectorAll('.tenure-check').forEach(el => el.textContent = '');
    document.getElementById('tenure-' + months).classList.add('selected');
    document.getElementById('check-' + months).textContent = '‚úì';
  }

  // Restore saved tenure
  if (selectedTenure) selectTenure(selectedTenure);

  // Restore saved postcode
  const savedPostcode = localStorage.getItem('postcodeFilter') || '';
  document.getElementById('postcode-input').value = savedPostcode;

  // Weekly slider
  const slider = document.getElementById('weekly-slider');
  const display = document.getElementById('weekly-display');
  const savedWeekly = localStorage.getItem('maxWeekly') || '400';
  slider.value = savedWeekly;
  display.textContent = savedWeekly === '400' ? '400+' : savedWeekly;
  slider.addEventListener('input', () => {
    display.textContent = slider.value === '400' ? '400+' : slider.value;
  });

  function applySearch() {
    if (selectedMonth) localStorage.setItem('startMonth', selectedMonth);
    if (selectedTenure) localStorage.setItem('tenure', selectedTenure);

    const postcode = document.getElementById('postcode-input').value.trim();
    if (postcode) {
      localStorage.setItem('postcodeFilter', postcode);
    } else {
      localStorage.removeItem('postcodeFilter');
    }

    const weekly = slider.value;
    if (weekly < 400) {
      localStorage.setItem('maxWeekly', weekly);
    } else {
      localStorage.removeItem('maxWeekly');
    }

    location.href = 'index.html';
  }
</script>
</body>
</html>
